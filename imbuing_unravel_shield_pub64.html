<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"> 
<HTML lang="ja">
<HEAD>
<meta http-equiv="content-type" content="text/html; charset=Shift_JIS">
<meta http-equiv="content-style-type" content="text/css">
<link href="style_2.css" type="text/css" rel="stylesheet">
<meta http-equiv="content-script-type" content="text/javascript">
<TITLE>盾抽出計算</TITLE>
</HEAD>
<BODY><!-- geoguide start --><div align=center><script language="javascript">var jps=382116062;var jpt=1541898835</script><script language="javascript" src="//bc-geocities.yahoo.co.jp/js/gg.js"></script></div><!-- geoguide end -->

<!--以下本文-->

<h2>盾抽出計算</h2>
<HR>

Imbuingスキルでアイテムを抽出（unravel）するときの参考に作成しました。
<br>キャラクター、抽出に使用する施設、付加されるマジック効果などを選択欄より選択します。
<br>過去、盾には「命中」プロパティが付加されていたため、選択欄にも命中プロパティを入れています。
<br>Publish63以降、素材効果のプロパティもマジック効果とみなされます。本来盾に付加されないHP回復、幸運、STR、DEXは"特殊素材プロパティ"から選択してください。
<br>盾の現在耐久値を入力し、"練成品"であれば、そこをチェックします。
<br>全強度計算ボタンを押すと、下に評価値および抽出される魔法素材が表示されます。

<h4>抽出に関する仕様</h4>
<ul class="list02">
  <li>素材効果のプロパティのうち、耐久値増加、重量軽減、抵抗値増加はマジック効果にはあたりません。それ以外はマジック効果とみなされ、抽出評価に反映されます。</li>
  <li>強度率を計算したプロパティが6以上となった場合、それらを5プロパティあたりの強度率に補正します。</li>
</ul>

<script language="JavaScript" type ="text/javascript">
<!--
function keisan0(form)
{
  form_keisan.prop1.value = 0.0;
  form_keisan.prop2.value = 0.0;
  form_keisan.prop3.value = 0.0;
  form_keisan.prop4.value = 0.0;
  form_keisan.prop5.value = 0.0;
  form_keisan.prop8.value = 0.0;
  form_keisan.prop9.value = 0.0;
  form_keisan.rat1.value = 0.0;
  form_keisan.rat2.value = 0.0;
  form_keisan.rat3.value = 0.0;
  form_keisan.rat4.value = 0.0;
  form_keisan.rat5.value = 0.0;
  form_keisan.rat8.value = 0.0;
  form_keisan.rat9.value = 0.0;
  form_keisan.imb.value = 0.0;
  form_keisan.hose.value = 0.0;
  form_keisan.rat.value = 0.0;
  return true;
}

//計算
function keisan1(form)
{
var form = document.form_keisan;

  prop1 = form_keisan.prop1.options[form.prop1.selectedIndex].value;
  prop2 = form_keisan.prop2.options[form.prop2.selectedIndex].value;
  prop3 = form_keisan.prop3.options[form.prop3.selectedIndex].value;
  prop4 = form_keisan.prop4.options[form.prop4.selectedIndex].value;
  prop5 = form_keisan.prop5.options[form.prop5.selectedIndex].value;
  prop6 = form_keisan.prop6.options[form.prop6.selectedIndex].value;
  rat8 = form_keisan.prop8.options[form.prop8.selectedIndex].value;
  rat9 = form_keisan.prop9.options[form.prop9.selectedIndex].value;
  rata = form_keisan.propa.options[form.propa.selectedIndex].value;
  kyo1 = form_keisan.kyo1.value;
  kyo2 = form_keisan.kyo2.value;
  kyo3 = form_keisan.kyo3.value;
  kyo4 = form_keisan.kyo4.value;
  kyo5 = form_keisan.kyo5.value;
  dur = form_keisan.dur.value;
  rat = 0.0;
  pn = 5.0;

  rata = rata/100 + 1.00;

  propp = (prop6)%10;
  prop6 = Math.floor((prop6)/10);

  if(prop1 == 0)
   {
    rat1 = 0.0;
    pn = pn - 1.0;
   }
  else if(prop1 <= 2)
   {
    rat1 = 100.0;
   }
  else if(prop1 == 3)
   {
    rat1 = Math.floor(100 * kyo1 / 5);
   }
  else if(prop1 <= 5)
   {
    rat1 = Math.floor(100 * kyo1 / 100);
   }
  else
   {
    rat1 = Math.floor(100 * kyo1 / 15);
   }
rat = eval(rat + rat1);

  if(prop2 == 0)
   {
    rat2 = 0.0;
    pn = pn - 1.0;
   }
  else if(prop2 <= 2)
   {
    rat2 = 100.0;
   }
  else if(prop2 == 3)
   {
    rat2 = Math.floor(100 * kyo2 / 5);
   }
  else if(prop2 <= 5)
   {
    rat2 = Math.floor(100 * kyo2 / 100);
   }
  else
   {
    rat2 = Math.floor(100 * kyo2 / 15);
   }
rat = eval(rat + rat2);

  if(prop3 == 0)
   {
    rat3 = 0.0;
    pn = pn - 1.0;
   }
  else if(prop3 <= 2)
   {
    rat3 = 100.0;
   }
  else if(prop3 == 3)
   {
    rat3 = Math.floor(100 * kyo3 / 5);
   }
  else if(prop3 <= 5)
   {
    rat3 = Math.floor(100 * kyo3 / 100);
   }
  else
   {
    rat3 = Math.floor(100 * kyo3 / 15);
   }
rat = eval(rat + rat3);

  if(prop4 == 0)
   {
    rat4 = 0.0;
    pn = pn - 1.0;
   }
  else if(prop4 <= 2)
   {
    rat4 = 100.0;
   }
  else if(prop4 == 3)
   {
    rat4 = Math.floor(100 * kyo4 / 5);
   }
  else if(prop4 <= 5)
   {
    rat4 = Math.floor(100 * kyo4 / 100);
   }
  else
   {
    rat4 = Math.floor(100 * kyo4 / 15);
   }
rat = eval(rat + rat4);

  if(prop5 == 0)
   {
    rat5 = 0.0;
    pn = pn - 1.0;
   }
  else if(prop5 <= 2)
   {
    rat5 = 100.0;
   }
  else if(prop5 == 3)
   {
    rat5 = Math.floor(100 * kyo5 / 5);
   }
  else if(prop5 <= 5)
   {
    rat5 = Math.floor(100 * kyo5 / 100);
   }
  else
   {
    rat5 = Math.floor(100 * kyo5 / 15);
   }
rat = eval(rat + rat5);

rat = eval(rat + prop6);
pn = pn + propp;

  if(pn >= 6.0)
   {
    rat = Math.floor(rat / pn) * 5.0;
   }

rat = eval(Math.floor(rat * rata) + rat8 * 1 + rat9 * 1);

   if(form.imb.checked){
     form.imb.value = 30.0;
}
   else{
     form.imb.value = 0.0;
}
  imb1 = form.imb.value;

dur = Math.min(100.0, dur * 2);

hose = Math.max(0.0, dur - imb1);

rat = Math.floor(rat * hose / 100.0);


 if(rat<1)
{
  document.zai = "抽出不可";
}
 else if(rat<50)
{
  document.zai = "Magical Residue × 1";
}
 else if(rat<100)
{
  document.zai = "Magical Residue × 2〜3";
}
 else if(rat<150)
{
  document.zai = "Magical Residue × 3〜4";
}
 else if(rat<200)
{
  document.zai = "Magical Residue × 4〜5";
}
 else if(rat<300)
{
  document.zai = "Enchanted Essence × 1〜2";
}
 else if(rat<400)
{
  document.zai = "Enchanted Essence × 2〜3";
}
 else if(rat<451)
{
  document.zai = "Enchanted Essence × 3〜4";
}
 else
{
  document.zai = "Relic Fragment × 1〜2";
}

  form.zai.value = document.zai;

form.rat1.value = rat1;
form.rat2.value = rat2;
form.rat3.value = rat3;
form.rat4.value = rat4;
form.rat5.value = rat5;
form.rat6.value = prop6;
form.rat8.value = rat8;
form.rat9.value = rat9;
form.rata.value = rata;
form.hose.value = hose;
form.rat.value = rat;

return true;
}
// -->
 </script>

<form name="form_keisan">

<h4>キャラクター・施設の特性</h4>

<table class="table02">

  <tr bgcolor="#f0f0f0">
    <td align="center" width="220">キャラクター・施設</td>
    <td align="center" width="120">強度率加算（％）</td>
  </tr>

  <tr bgcolor="#f0f0f0">
    <td align="center"><select name="prop8" size="1">
<option value="0">Human
<option value="0">Elf
<option value="20">Gargoyle
</select>
</td>
    <td align="center"><INPUT class="readtext" readonly type="text" name="rat8" size="4" value="0">％</td>
  </tr>

  <tr bgcolor="#f0f0f0">
    <td align="center"><select name="prop9" size="1">
<option value="0">普通のSoul Forge
<option value="10">Royal CityのSoul Forge
<option value="30">Queen's Soul Forge
</select>
</td>
    <td align="center"><INPUT class="readtext" readonly type="text" name="rat9" size="4" value="0">％</td>
  </tr>

</table>


<h4>アイテムの特性</h4>


<table class="table02">

  <tr bgcolor="#f0f0f0">
    <td align="center" width="220">プロパティ選択</td>
    <td align="center" width="120">プロパティ強度</td>
    <td align="center" width="120">強度率（％）</td>
  </tr>

  <tr bgcolor="#ccccff">
    <td align="center">
<select name="prop1" SIZE="1">
<option value="0">---------------
<option value="3">自己修復
<option value="4">耐久性
<option value="6">命中
<option value="7">回避
<option value="8">物理ダメージ反射
<option value="5">装備条件(−は省略)
<option value="1">ファストキャスト1(強度省略)
<option value="2">詠唱可+FC-1(強度省略)
</select>
    </td>
    <td align="center"><INPUT type="text" name="kyo1" size="4" value="0"></td>
    <td align="center"><INPUT class="readtext" readonly type="text" name="rat1" size="4" value="0">％</td>
  </tr>

  <tr bgcolor="#ddddff">
    <td align="center">
<select name="prop2" SIZE="1">
<option value="0">---------------
<option value="3">自己修復
<option value="4">耐久性
<option value="6">命中
<option value="7">回避
<option value="8">物理ダメージ反射
<option value="5">装備条件(−は省略)
<option value="1">ファストキャスト1(強度省略)
<option value="2">詠唱可+FC-1(強度省略)
</select>
    </td>
    <td align="center"><INPUT type="text" name="kyo2" size="4" value="0"></td>
    <td align="center"><INPUT class="readtext" readonly type="text" name="rat2" size="4" value="0">％</td>
  </tr>

  <tr bgcolor="#ccccff">
    <td align="center">
<select name="prop3" SIZE="1">
<option value="0">---------------
<option value="3">自己修復
<option value="4">耐久性
<option value="6">命中
<option value="7">回避
<option value="8">物理ダメージ反射
<option value="5">装備条件(−は省略)
<option value="1">ファストキャスト1(強度省略)
<option value="2">詠唱可+FC-1(強度省略)
</select>
    </td>
    <td align="center"><INPUT type="text" name="kyo3" size="4" value="0"></td>
    <td align="center"><INPUT class="readtext" readonly type="text" name="rat3" size="4" value="0">％</td>
  </tr>

  <tr bgcolor="#ddddff">
    <td align="center">
<select name="prop4" SIZE="1">
<option value="0">---------------
<option value="3">自己修復
<option value="4">耐久性
<option value="6">命中
<option value="7">回避
<option value="8">物理ダメージ反射
<option value="5">装備条件(−は省略)
<option value="1">ファストキャスト1(強度省略)
<option value="2">詠唱可+FC-1(強度省略)
</select>
    </td>
    <td align="center"><INPUT type="text" name="kyo4" size="4" value="0"></td>
    <td align="center"><INPUT class="readtext" readonly type="text" name="rat4" size="4" value="0">％</td>
  </tr>

  <tr bgcolor="#ccccff">
    <td align="center">
<select name="prop5" SIZE="1">
<option value="0">---------------
<option value="3">自己修復
<option value="4">耐久性
<option value="6">命中
<option value="7">回避
<option value="8">物理ダメージ反射
<option value="5">装備条件(−は省略)
<option value="1">ファストキャスト1(強度省略)
<option value="2">詠唱可+FC-1(強度省略)
</select>
    </td>
    <td align="center"><INPUT type="text" name="kyo5" size="4" value="0"></td>
    <td align="center"><INPUT class="readtext" readonly type="text" name="rat5" size="4" value="0">％</td>
  </tr>

  <tr bgcolor="#ddddff">
    <td align="center" colspan="2">
<select name="prop6" SIZE="1">
<option value="0">特殊素材プロパティ
<option value="401">幸運 40 [gold]
<option value="251">STR 2 [heartwood]
<option value="251">DEX 2 [heartwood]
<option value="501">HP回復1 [yew]
<option value="1402">HP回復2, 幸運40[bloodwood]
</select>
    </td>
    <td align="center"><INPUT class="readtext" readonly type="text" name="rat6" size="4" value="0">％</td>
  </tr>

  <tr bgcolor="#ffffcc">
    <td align="center" colspan="2">
<select name="propa" SIZE="1">
<option value="0">---- 素材の種類 ----
<option value="0">普通素材
<option value="2">Dull copper
<option value="3">Shadow iron
<option value="4">Copper
<option value="5">Bronze
<option value="7">Gold
<option value="9">Agapite
<option value="12">Verite
<option value="20">Valorite
<option value="1">Oak
<option value="3">Ash
<option value="7">Yew
<option value="10">Heartwood
<option value="15">Bloodwood
<option value="20">Frostwood
</select>
    </td>
    <td align="center">×<INPUT class="readtext" readonly type="text" name="rata" size="4" value="0"></td>
  </tr>

  <tr bgcolor="#ffffcc">
    <td align="center">耐久値　：　<INPUT type="text" name="dur" size="4" value="50"></td>
    <td align="center"><INPUT Type="checkbox" name="imb" value="yes">練成品</td>
    <td align="center">×<INPUT class="readtext" readonly type="text" name="hose" size="4" value="0">％</td>
  </tr>

</table>


<input type="button" value="プロパティ・全強度計算" onclick="keisan1(form)">　<INPUT TYPE="reset" value="リセット">

<h4>抽出結果の推定</h4>

<ul class="list03">
  <li>抽出評価値　：　<INPUT class="readtext" readonly type="text" name="rat" size="4" value="0">％</li>
  <li>魔法素材　：　<INPUT class="readtext" readonly type="text" name="zai" size="25"></li>
</ul>

</form>

</BODY>
</HTML>
<!-- text below generated by geocities.jp --></object></layer></div></span></style></noscript></table></script></applet><script language="javascript" src="//bc-geocities.yahoo.co.jp/js/geov2.js"></script><script language="javascript">geovisit();</script>